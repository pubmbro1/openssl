/*
 ============================================================================
 Name        : ecdh.c
 Author      : 
 Version     :
 Copyright   : Your copyright notice
 Description : Hello World in C, Ansi-style
 ============================================================================
 */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <openssl/evp.h>
#include <openssl/ec.h>

int main(void) {
	puts("!!!Hello World!!!"); /* prints !!!Hello World!!! */

	/* Public Key serialize
	 * peerkey -> (EVP_PKEY_get1_EC_Key) -> peer_eckey -> (EVP_PKEY_get0_public_key
	 * 				-> peer_pubc_ecpoint -> (EC_POINT_point2oct) -> char[] *peerPubKeyChar
	 *  */

	EVP_PKEY_CTX *pctx = EVP_PKEY_CTX_new_id(EVP_PKEY_EC, NULL);
	EVP_PKEY_paramgen_init(pctx);

	EVP_PKEY_CTX_set_ec_paramgen_curve_nid(pctx, NID_X9_62_prime256v1);
	EVP_PKEY *params = NULL;
	EVP_PKEY_paramgen(pctx, &params);

	EVP_PKEY_CTX *kctx = EVP_PKEY_CTX_new(params, NULL);
	EVP_PKEY *pkey = EVP_PKEY_new();
	EVP_PKEY_keygen_init(kctx);
	EVP_PKEY_keygen(kctx, &pkey);

	EVP_PKEY_CTX *kctx = EVP_PKEY_CTX_new(params, NULL);
	EVP_PKEY *peerkey = EVP_PKEY_new();
	EVP_PKEY_keygen_init(kctx);
	EVP_PKEY_keygen(kctx, &peerkey);

	return EXIT_SUCCESS;
}
